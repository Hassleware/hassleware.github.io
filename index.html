<!DOCTYPE html>
<html>
<head>
    <title>Ryan's Art Portfolio</title>
    <meta charset="utf-8">
    <meta content='width=device-width, initial-scale=1' name='viewport'>
    <style>
        /* --- LIGHT THEME STYLING --- */
        body {
            font-family: sans-serif;
            margin: 0;
            padding: 20px;
            background-color: white;
            color: black;
            text-align: center;
        }

        h2 { 
            margin-top: 40px; 
            text-transform: uppercase;
            font-size: 1.5rem; 
        }

        /* --- GALLERY --- */
        .gallery-section {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            min-height: 100px;
        }

        .thumb-img {
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
            background-color: white; 
            cursor: pointer;
            transition: opacity 0.2s ease-in-out;
            max-width: 100%;
            height: auto; 
            /* Default size for Digital Drawings */
            max-height: 300px; 
            object-fit: contain;
        }

        /* UPDATED: Real Drawings specific styling */
        #real-gallery .thumb-img {
            box-shadow: none;
            /* 40% bigger than the standard 300px */
            max-height: 420px; 
        }

        .thumb-img:hover { 
            opacity: 0.5;
        }

        /* --- MODAL UPDATES --- */
        #modal {
            display: none; 
            position: fixed; 
            z-index: 1000; 
            left: 0; top: 0;
            width: 100%; height: 100%; 
            background-color: rgba(0, 0, 0, 0.85); 
            overflow: auto; 
            align-items: flex-start; 
            justify-content: center;
            padding-top: 60px; 
            padding-bottom: 60px;
        }

        #modal-card {
            display: flex;
            flex-direction: row; 
            position: relative;
            max-width: none;
            max-height: none;
            background: transparent;
            box-shadow: none; 
            margin: auto; 
        }

        /* Base Modal Image Styling */
        #modal-img {
            display: block;
            image-rendering: pixelated; 
            background-color: white; 
            min-width: 200px; 
        }

        /* STYLE A: GIF (Raw Size) */
        #modal-img.modal-raw {
            width: auto; 
            height: auto;
            max-width: none;
            max-height: none;
        }

        /* STYLE B: JPG or PNG (Constrained) */
        #modal-img.modal-fit {
            height: 70vh;  /* 70% of viewport height */
            width: auto;   /* Maintain aspect ratio */
            max-width: 100%; 
        }

        #modal-desc {
            width: 300px; 
            min-width: 200px;
            background-color: white; 
            color: black;            
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start; 
            text-align: left;
        }

        .close-btn {
            position: absolute;
            top: -40px;
            right: 0;
            color: white; 
            font-size: 30px;
            font-weight: bold;
            cursor: pointer;
            z-index: 1001;
            padding: 5px 10px;
            text-shadow: 0 0 5px black;
        }

        @media (max-width: 800px) {
            body { padding: 10px; }
            
            #modal-card { 
                flex-direction: column; 
                align-items: center; 
                background: white; 
            }
            
            #modal-img.modal-fit { 
                height: auto;
                max-height: 60vh; 
                max-width: 100%;
            }

            #modal-desc { 
                width: 100%; 
                box-sizing: border-box; 
            }

            .close-btn {
                top: -40px; 
                right: 0;
            }
        }
    </style>
</head>
<body>

    <h1>Ryan's Portfolio</h1>

    <h2 id="digital-title">Loading Digital...</h2>
    <div id="digital-gallery" class="gallery-section"></div>

    <h2 id="real-title">Loading Real...</h2>
    <div id="real-gallery" class="gallery-section"></div>

    <div id="modal">
        <div id="modal-card">
            <span class="close-btn">&times;</span>
            <img id="modal-img" src="">
            <div id="modal-desc">
                <div id="sidebar-content">Loading info...</div>
            </div>
        </div>
    </div>

    <script>
        const modal = document.getElementById('modal');
        const modalImg = document.getElementById('modal-img');
        const sidebarContent = document.getElementById('sidebar-content');
        const closeBtn = document.querySelector('.close-btn');

        function closeModal() {
            modal.style.display = "none";
            modalImg.src = ""; 
            modalImg.className = ""; 
        }

        modal.addEventListener('click', function(e) {
            if (e.target.id === 'modal') closeModal();
        });

        closeBtn.addEventListener('click', closeModal);

        // Helper: Configures the modal to open with specific style (Raw or Fit)
        function setupModalClick(element, imageFile, htmlFile, styleClass) {
            element.addEventListener('click', function() {
                modal.style.display = "flex"; 
                modalImg.src = imageFile; 
                
                modalImg.className = ""; 
                modalImg.classList.add(styleClass);

                sidebarContent.innerHTML = "<em>Checking for description...</em>";

                fetch(htmlFile)
                .then(response => {
                    if (!response.ok) throw new Error("No description");
                    return response.text();
                })
                .then(htmlText => {
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(htmlText, 'text/html');
                    const descDiv = doc.getElementById('description') || doc.querySelector('[tag="description"]');
                    if (descDiv) sidebarContent.innerHTML = descDiv.innerHTML;
                    else sidebarContent.innerHTML = "<em>Found file, but missing &lt;div id='description'&gt;</em>";
                })
                .catch(err => {
                    sidebarContent.innerHTML = "<p>No description text found.</p>";
                });
            });
        }

        // Helper: Logic to check if a GIF exists, then proceed to next index
        function checkGifAndBind(baseImageSrc, prefix, modalExt, htmlFile, galleryId, titleId, index) {
            
            const gifFile = prefix + index + modalExt;
            const gallery = document.getElementById(galleryId);
            
            // create the thumbnail element (using baseImageSrc)
            const thumb = document.createElement('img');
            thumb.src = baseImageSrc;
            thumb.className = "thumb-img"; 
            gallery.appendChild(thumb);

            const gifCheck = new Image();
            gifCheck.src = gifFile;

            gifCheck.onload = function() {
                // GIF exists -> Use GIF (Raw Size)
                setupModalClick(thumb, gifFile, htmlFile, 'modal-raw');
                // Next
                loadCollection(prefix, galleryId, titleId, index + 1);
            };

            gifCheck.onerror = function() {
                // GIF missing -> Use Base Image (Fit Size)
                setupModalClick(thumb, baseImageSrc, htmlFile, 'modal-fit');
                // Next
                loadCollection(prefix, galleryId, titleId, index + 1);
            };
        }

        // Main recursion
        function loadCollection(prefix, galleryId, titleId, index = 1) {
            
            const title = document.getElementById(titleId);
            const htmlFile = prefix + index + ".html";

            // Define possible base files
            const jpgFile = prefix + index + ".jpg";
            const pngFile = prefix + index + ".png";
            const modalExt = ".gif";

            // 1. Try Loading JPG
            const jpgLoader = new Image();
            jpgLoader.src = jpgFile;

            jpgLoader.onload = function() {
                // JPG found. Now check GIF.
                checkGifAndBind(jpgFile, prefix, modalExt, htmlFile, galleryId, titleId, index);
            };

            jpgLoader.onerror = function() {
                // JPG failed. 2. Try Loading PNG
                const pngLoader = new Image();
                pngLoader.src = pngFile;

                pngLoader.onload = function() {
                    // PNG found. Now check GIF.
                    checkGifAndBind(pngFile, prefix, modalExt, htmlFile, galleryId, titleId, index);
                };

                pngLoader.onerror = function() {
                    // Both JPG and PNG failed. End of Gallery.
                    const finalCount = index - 1;
                    if (galleryId === 'digital-gallery') {
                        title.innerText = finalCount + " Digital Arts";
                    } else {
                        title.innerText = finalCount + " Canvas Arts";
                    }
                };
            };
        }

        loadCollection("", "digital-gallery", "digital-title");
        loadCollection("r-", "real-gallery", "real-title");

    </script>
</body>
</html>